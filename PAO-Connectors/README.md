# Wrike API Connector for Power Automate

This directory contains the necessary definition files to create a custom connector for the Wrike API within Microsoft Power Automate. A custom connector acts as a wrapper around the Wrike REST API, allowing you to integrate Wrike's project management capabilities directly into your automated workflows.

## Files in This Directory

This folder provides multiple OpenAPI (formerly Swagger) definition files. You only need to import **one** of these into Power Automate to create the connector.

*   **[WrikeAPI-PAO-Connector.json](WrikeAPI-PAO-Connector.json)**
    *   **Format**: JSON
    *   **Description**: This is the primary, custom-crafted OpenAPI definition created by the WPP Wrike Global Team. It is tailored for specific integration needs and may represent a curated subset of the full Wrike API.

*   **[WrikeAPI-PAO-Connector.yaml](WrikeAPI-PAO-Connector.yaml)**
    *   **Format**: YAML
    *   **Description**: This is the YAML version of the custom-crafted connector. It is functionally identical to the JSON file and is provided as an alternative format preference.

*   **[WrikeAPI-Native-PAO-Connector.yaml](WrikeAPI-Native-PAO-Connector.yaml)**
    *   **Format**: YAML
    *   **Description**: This connector definition is based on the complete, officially published Wrike API v4 specification. It offers a more comprehensive set of actions that directly correspond to the native API.

### Which File Should I Use?

*   For most standard use cases within the team, start with **`WrikeAPI-PAO-Connector.json`**.
*   If you require an API endpoint that is not available in the custom-crafted version, use **`WrikeAPI-Native-PAO-Connector.yaml`** or reach out to our team make it available into the curated connector.
*   The YAML files are provided as alternatives if your tooling or preference is for YAML over JSON.

## How to Use

To use these files, you need to create a new custom connector in your Power Automate environment.

### Step 1: Create an API App in Wrike

Before creating the connector, you must register an application within Wrike to obtain a `Client ID` and `Client Secret`.

1.  Log in to Wrike and navigate to the **Apps & Integrations** section.
2.  Open the Wrike Developers Portal and create a new app.
3.  Set the **Redirect URI** to the value that Power Automate will provide you in the next steps. A common placeholder to use initially is `https://global.consent.azure-apim.net/redirect`.
4.  Once the app is created, securely copy the **Client ID** and **Client Secret**.

### Step 2: Import the Connector in Power Automate

1.  Navigate to **Power Automate**.
2.  In the left-hand menu, go to **Data > Custom connectors**.
3.  In the top right corner, click **New custom connector** and select **Import an OpenAPI file**.
4.  Give your connector a name (e.g., "Wrike API Custom") and upload your chosen file (`.json` or `.yaml`) from this folder.
5.  Click **Continue**.

### Step 3: Configure the Connector

1.  **General Tab**: The API host and base URL will be pre-filled from the definition file (e.g., `app-eu.wrike.com` and `/api/v4`). You can upload an icon for the connector here.
2.  **Security Tab**:
    *   Select **OAuth 2.0** as the Authentication type.
    *   Choose `Wrike` as the Identity Provider. If it's not listed, use `Generic Oauth 2`.
    *   Enter the **Client ID** and **Client Secret** you obtained from Wrike.
    *   Set the **Authorization URL** to `https://login.wrike.com/oauth2/authorize/v4`.
    *   Set the **Token URL** and **Refresh URL** to `https://login.wrike.com/oauth2/token`.
    *   The **Redirect URL** will now be generated by Power Automate. Copy this URL and paste it into the **Redirect URI** field of your app in the Wrike Developers Portal.
3.  **Definition Tab**: Review the actions (API endpoints) that have been imported from the file. You can adjust summaries, descriptions, and visibility here.
4.  **Create Connector**: Click the **Create connector** button at the top.

### Step 4: Test the Connector

After creating the connector, go to the **Test** tab. Create a new connection, which will prompt you to log in to Wrike and authorize the application. Once connected, you can test the various actions to ensure they are working correctly.
